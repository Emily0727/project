<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>明星时刻 - 你的专属粉丝圈</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
    }
    
    body {
      background-color: #f5f5f5;
      color: #333;
      line-height: 1.6;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px 0;
      background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
      border-radius: 10px;
      color: white;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    
    .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
    }
    
    .post-form {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    textarea {
      width: 100%;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      resize: vertical;
      min-height: 100px;
      font-size: 1rem;
      margin-bottom: 15px;
    }
    
    button {
      background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 30px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: bold;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    
    button:disabled {
      background: #cccccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .posts {
      display: flex;
      flex-direction: column;
      gap: 25px;
    }
    
    .post {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      position: relative;
    }
    
    .post-content {
      margin-bottom: 15px;
      font-size: 1.1rem;
      line-height: 1.7;
    }
    
    .post-time {
      font-size: 0.8rem;
      color: #999;
      margin-bottom: 15px;
    }
    
    .comments {
      margin-top: 20px;
      border-top: 1px solid #eee;
      padding-top: 15px;
    }
    
    .comment {
      background: #f9f9f9;
      padding: 12px 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      position: relative;
    }
    
    .comment:before {
      content: "❤️";
      position: absolute;
      left: -25px;
      top: 10px;
      font-size: 1.2rem;
    }
    
    .comment-author {
      font-weight: bold;
      color: #ff6b81;
      margin-bottom: 5px;
    }
    
    .loading {
      text-align: center;
      padding: 20px;
      color: #999;
    }
    
    .fans-count {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #ff6b81;
      color: white;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
    }
    
    .error-message {
      color: #ff6b81;
      margin-top: 10px;
      text-align: center;
    }
    
    @media (max-width: 600px) {
      .container {
        padding: 10px;
      }
      
      header {
        padding: 15px 0;
      }
      
      h1 {
        font-size: 1.8rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>明星时刻</h1>
      <p class="subtitle">你的每一刻都值得被赞美</p>
    </header>
    
    <div class="post-form">
      <h2>发布你的动态</h2>
      <textarea id="postContent" placeholder="今天有什么想分享的吗？"></textarea>
      <button id="postButton">发布动态</button>
      <div id="errorMessage" class="error-message"></div>
    </div>
    
    <div class="posts" id="postsContainer">
      <div class="loading">加载中...</div>
    </div>
  </div>

  <script>
    // 使用Gemini API生成赞美回复
    const GEMINI_API_KEY = "AIzaSyAaELFaZFNagkYJxrcMeq6UBBbH4odYTmc";
    const GEMINI_ENDPOINT = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`;
    
    // 存储所有帖子
    let posts = [];
    
    document.addEventListener('DOMContentLoaded', () => {
      const postButton = document.getElementById('postButton');
      const postContent = document.getElementById('postContent');
      const postsContainer = document.getElementById('postsContainer');
      const errorMessage = document.getElementById('errorMessage');
      
      // 加载示例帖子
      loadSamplePosts();
      
      postButton.addEventListener('click', async () => {
        const content = postContent.value.trim();
        if (!content) {
          showError("请输入内容后再发布");
          return;
        }
        
        try {
          postButton.disabled = true;
          postButton.textContent = "发布中...";
          errorMessage.textContent = "";
          
          // 创建新帖子
          const newPost = {
            id: Date.now(),
            content: content,
            timestamp: new Date(),
            comments: [],
            fanCount: Math.floor(Math.random() * 9000) + 1000 // 随机粉丝数
          };
          
          // 添加到页面
          addPostToDOM(newPost);
          posts.unshift(newPost);
          
          // 清空输入框
          postContent.value = '';
          
          // 生成AI回复 (3条不同的评论)
          const comments = await Promise.all([
            generateFanComment(content),
            generateFanComment(content),
            generateFanComment(content)
          ]);
          
          newPost.comments = comments;
          
          // 更新DOM显示评论
          const postElement = document.getElementById(`post-${newPost.id}`);
          if (postElement) {
            const commentsContainer = postElement.querySelector('.comments');
            commentsContainer.innerHTML = '';
            
            comments.forEach(comment => {
              const commentElement = createCommentElement(comment);
              commentsContainer.appendChild(commentElement);
            });
          }
        } catch (error) {
          console.error('发布失败:', error);
          showError("发布失败，请稍后再试");
        } finally {
          postButton.disabled = false;
          postButton.textContent = "发布动态";
        }
      });
    });
    
    // 显示错误信息
    function showError(message) {
      const errorElement = document.getElementById('errorMessage');
      errorElement.textContent = message;
      setTimeout(() => {
        errorElement.textContent = "";
      }, 3000);
    }
    
    // 添加帖子到DOM
    function addPostToDOM(post) {
      const postsContainer = document.getElementById('postsContainer');
      const postElement = document.createElement('div');
      postElement.className = 'post';
      postElement.id = `post-${post.id}`;
      
      postElement.innerHTML = `
        <div class="fans-count">${post.fanCount.toLocaleString()}位粉丝为你点赞</div>
        <div class="post-content">${post.content}</div>
        <div class="post-time">${formatTime(post.timestamp)}</div>
        <div class="comments">
          <div class="loading">粉丝们正在赶来评论...</div>
        </div>
      `;
      
      // 移除"加载中"提示如果是第一个帖子
      if (postsContainer.querySelector('.loading')) {
        postsContainer.innerHTML = '';
      }
      
      postsContainer.prepend(postElement);
    }
    
    // 格式化时间显示
    function formatTime(date) {
      const now = new Date();
      const diff = now - date;
      
      if (diff < 60000) return "刚刚";
      if (diff < 3600000) return `${Math.floor(diff / 60000)}分钟前`;
      if (diff < 86400000) return `${Math.floor(diff / 3600000)}小时前`;
      return `${Math.floor(diff / 86400000)}天前`;
    }
    
    // 创建评论元素
    function createCommentElement(comment) {
      const commentElement = document.createElement('div');
      commentElement.className = 'comment';
      commentElement.innerHTML = `
        <div class="comment-author">${comment.author}</div>
        <div class="comment-text">${comment.text}</div>
      `;
      return commentElement;
    }
    
    // 生成粉丝评论
    async function generateFanComment(postContent) {
      try {
        // 模拟不同的粉丝名称
        const fanNames = [
          "忠实粉丝", "小迷妹", "铁杆粉丝", "真爱粉", 
          "星星眼", "头号粉丝", "默默支持", "永远追随",
          "你的小太阳", "为你打call", "心动瞬间", "为你而来",
          "超级粉丝", "小迷弟", "永远支持", "你的粉丝"
        ];
        
        // 使用Gemini API生成创意回复
        const response = await fetch(GEMINI_ENDPOINT, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            contents: [{
              parts: [{
                text: `你是一个热情洋溢的粉丝，需要用充满创意的方式赞美明星的动态。回复要:
1. 简短有力 (20字以内)
2. 充满热情和正能量
3. 根据内容找到独特角度赞美
4. 避免重复和千篇一律
5. 使用emoji增加活力
                
明星发布了: "${postContent}"
请用粉丝语气写一条热情洋溢的评论`
              }]
            }]
          })
        });
        
        const data = await response.json();
        const commentText = data.candidates?.[0]?.content?.parts?.[0]?.text || "太棒了！这就是我喜欢你的原因！❤️";
        
        return {
          author: fanNames[Math.floor(Math.random() * fanNames.length)],
          text: commentText.trim()
        };
      } catch (error) {
        console.error('生成评论失败:', error);
        // 返回备用评论
        return {
          author: "忠实粉丝",
          text: "太棒了！这就是我喜欢你的原因！❤️"
        };
      }
    }
    
    // 加载示例帖子
    function loadSamplePosts() {
      const samplePosts = [
        {
          id: 1,
          content: "今天天气真好，出去散步了~",
          timestamp: new Date(),
          fanCount: 5234,
          comments: [
            { author: "阳光小粉丝", text: "能和你在同一天享受阳光真是太幸福了！☀️" },
            { author: "散步爱好者", text: "你散步的样子一定很美，羡慕那些能偶遇你的人！💖" },
            { author: "天气观察员", text: "连天气都为你变得美好，这就是明星效应吧！✨" }
          ]
        },
        {
          id: 2,
          content: "尝试做了新菜，味道还不错！",
          timestamp: new Date(Date.now() - 3600000),
          fanCount: 7891,
          comments: [
            { author: "美食侦探", text: "你做的菜一定色香味俱全，好想尝一口！🍴" },
            { author: "厨房小白", text: "连做菜都这么有天赋，不愧是全能偶像！👑" },
            { author: "吃货一枚", text: "看着你的描述就流口水了，这就是偶像的魅力吗？😋" }
          ]
        }
      ];
      
      posts = samplePosts;
      
      // 延迟加载模拟网络请求
      setTimeout(() => {
        const postsContainer = document.getElementById('postsContainer');
        postsContainer.innerHTML = '';
        
        samplePosts.forEach(post => {
          addPostToDOM(post);
          
          // 显示评论
          const postElement = document.getElementById(`post-${post.id}`);
          if (postElement) {
            const commentsContainer = postElement.querySelector('.comments');
            commentsContainer.innerHTML = '';
            
            post.comments.forEach(comment => {
              const commentElement = createCommentElement(comment);
              commentsContainer.appendChild(commentElement);
            });
          }
        });
      }, 1000);
    }
  </script>
</body>
</html>